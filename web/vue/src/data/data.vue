<template lang='jade'>
  .contain
    .text(v-html='intro')
    .hr
    h2 Available datasets
    .txt--center.my2(v-if='datasetScanstate === "idle"')
      a.w100--s.btn--blue.scan-btn(href='#', v-on:click.prevent='scan') scan available data
    .txt--center.my2(v-if='datasetScanstate === "scanning"')
      spinner
    .my2(v-if='datasetScanstate === "scanned"')
      .bg--orange.p1.warning.my1(v-if='unscannableMakets.length')
        p Unable to find datasets in the following markets:
        .mx2(v-for='market in unscannableMakets')
          | - {{ market.exchange }}:{{ market.currency }}:{{ market.asset }}
      table.full
        thead
          tr
            th exchange
            th currency
            th asset
            th from
            th to
            th duration
        tbody
          tr(v-for='set in datasets')
            td {{ set.exchange }}
            td {{ set.currency }}
            td {{ set.asset }}
            td {{ fmt(set.from) }}
            td {{ fmt(set.to) }}
            td {{ humanizeDuration(set.to.diff(set.from)) }}
    .my2
      h2 Import more data
      p.text You can easily import more market data directly from exchanges using the importer.
      router-link(to='/data/importer') Go to the importer.
</template>

<script>

import spinner from '../global/blockSpinner.vue'
import marked from '../tools/marked'
import dataset from '../global/mixins/dataset'
// global moment
// global humanizeDuration

let intro = marked(`

## Local data

Gekko needs local market data in order to backtest strategies. The local
data can also be used in a warmup period when running a strategy against a
live market.

`);

export default {
  mixins: [ dataset ],
  components: {
    spinner
  },
  data: () => {
    return {
      intro
    }
  },
  methods: {
    humanizeDuration: (n) => window.humanizeDuration(n),
    fmt: mom => mom.format('YYYY-MM-DD HH:mm')
  }
}
</script>

<style>
table.full {
  width: 100%;
}

table.full td {
  padding: 0.5rem 0;
}

table.full th {
  text-align: center;
}

.warning p {
  margin: 0;
  padding: 0;
}
</style>
